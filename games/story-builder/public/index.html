<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Story Builder &#x1F4DD;</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
</head>
<body>

  <!-- Lobby -->
  <div id="lobbyScreen" class="screen">
    <div class="lobby-wrap">
      <div class="lobby-header">
        <h1 class="logo">&#x1F4DD; Story Builder</h1>
        <p class="subtitle">Collaborate. Create. One sentence at a time.</p>
      </div>

      <div class="lobby-card">
        <div class="field">
          <label for="playerName">Your Name</label>
          <input type="text" id="playerName" maxlength="20" placeholder="Enter name..." autocomplete="off">
        </div>

        <button id="createRoomBtn" class="btn btn-primary"><span class="ico">&#x270D;&#xFE0F;</span> Create Room</button>

        <div class="divider"><span>OR</span></div>

        <div class="join-row">
          <input type="text" id="roomCodeInput" maxlength="6" placeholder="Room Code" class="code-input" autocomplete="off">
          <button id="joinRoomBtn" class="btn btn-accent">Join</button>
        </div>

        <!-- Settings -->
        <details class="settings-panel" open>
          <summary>&#x2699;&#xFE0F; Room Settings</summary>
          <div class="setting">
            <label>Rounds</label>
            <div class="pills">
              <button class="pill" data-rounds="1">1</button>
              <button class="pill" data-rounds="2">2</button>
              <button class="pill active" data-rounds="3">3</button>
              <button class="pill" data-rounds="5">5</button>
            </div>
          </div>
          <div class="setting">
            <label>Turn Timer (sec)</label>
            <div class="pills">
              <button class="timer-pill" data-timer="30">30</button>
              <button class="timer-pill active" data-timer="45">45</button>
              <button class="timer-pill" data-timer="60">60</button>
              <button class="timer-pill" data-timer="90">90</button>
            </div>
          </div>
          <div class="setting">
            <label>Story Prompt (optional)</label>
            <input type="text" id="promptInput" maxlength="200" placeholder="e.g. It was a dark and stormy night..." class="prompt-input" autocomplete="off">
          </div>
        </details>

        <div id="lobbyError" class="error-msg"></div>
      </div>

      <!-- Active rooms -->
      <div id="roomListWrap" class="room-list-wrap" style="display:none">
        <h3>Active Rooms</h3>
        <div id="roomList" class="room-list"></div>
      </div>
    </div>
  </div>

  <!-- Waiting Room -->
  <div id="waitingScreen" class="screen" style="display:none">
    <div class="waiting-wrap">
      <h2>&#x1F4DD; Story Builder</h2>
      <div class="room-code-display">
        Room: <span id="waitingRoomCode">----</span>
        <button id="copyCodeBtn" class="btn-sm" title="Copy code">&#x1F4CB;</button>
      </div>
      <div id="waitingPrompt" class="waiting-prompt" style="display:none"></div>
      <div id="waitingSettings" class="waiting-settings"></div>
      <div id="waitingPlayers" class="waiting-players"></div>
      <button id="startGameBtn" class="btn btn-primary" style="display:none">&#x1F680; Start Writing!</button>
      <p id="waitingMsg" class="waiting-msg">Waiting for the host to start...</p>
    </div>
  </div>

  <!-- Game Screen -->
  <div id="gameScreen" class="screen" style="display:none">
    <div class="game-layout">
      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="room-info">
          <div class="room-badge">&#x1F4DD; <span id="gameRoomCode">----</span></div>
          <div id="roundInfo" class="round-info">Round 1/3</div>
        </div>
        <h3>Writers</h3>
        <ul id="playerListSidebar" class="player-list"></ul>

        <!-- Chat -->
        <div class="chat-section">
          <div id="chatMessages" class="chat-messages"></div>
          <div class="chat-input-row">
            <input type="text" id="chatInput" maxlength="200" placeholder="Chat..." autocomplete="off">
            <button id="chatSendBtn" class="btn-sm">&#x27A1;&#xFE0F;</button>
          </div>
        </div>
      </aside>

      <!-- Main area -->
      <main class="main-area">
        <!-- Turn banner -->
        <div id="turnBanner" class="turn-banner">
          <span id="turnWriter" class="turn-writer"></span>
          <div id="timerBar" class="timer-bar"><div id="timerFill" class="timer-fill"></div></div>
          <span id="timerText" class="timer-text">45s</span>
        </div>

        <!-- Story display -->
        <div id="storyContainer" class="story-container">
          <div id="storyPromptDisplay" class="story-prompt" style="display:none"></div>
          <div id="storyContent" class="story-content">
            <p class="story-placeholder">The story will appear here once the first sentence is written...</p>
          </div>
        </div>

        <!-- Sentence input -->
        <div id="inputArea" class="input-area" style="display:none">
          <div class="input-wrap">
            <textarea id="sentenceInput" maxlength="280" rows="2" placeholder="Write your sentence..."></textarea>
            <div class="input-footer">
              <span id="charCounter" class="char-counter">0/280</span>
              <button id="submitBtn" class="btn btn-primary">Submit &#x2713;</button>
            </div>
          </div>
        </div>

        <div id="waitingForWriter" class="waiting-for-writer" style="display:none">
          <p>Waiting for <span id="waitingWriterName"></span> to write...</p>
        </div>
      </main>
    </div>
  </div>

  <!-- Game Over Screen -->
  <div id="gameOverScreen" class="screen" style="display:none">
    <div class="gameover-wrap">
      <h2>&#x1F4D6; The Story is Complete!</h2>
      <div id="finalStory" class="final-story"></div>
      <div id="writerStats" class="writer-stats"></div>
      <div class="gameover-actions">
        <button id="copyStoryBtn" class="btn btn-accent">&#x1F4CB; Copy Story</button>
        <button id="playAgainBtn" class="btn btn-primary">&#x1F504; Play Again</button>
      </div>
    </div>
  </div>

  <div id="toast" class="toast"></div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="app.js"></script>
</body>
</html>
